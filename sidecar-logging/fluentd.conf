# Configuración mejorada de Fluentd para ADN Alert System
<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Logs de backend con etiquetas específicas
<filter backend.**>
  @type record_transformer
  <record>
    service_type backend
    container_name ${tag_parts[1]}
    log_source application
  </record>
</filter>

# Logs del sistema Fluentd
<filter fluent.**>
  @type record_transformer
  <record>
    service_type fluentd
    log_source system
  </record>
</filter>

# Guardar logs de backend en archivos separados
<match backend.**>
  @type file
  path /shared/logs/backend/backend-app
  append true
  <format>
    @type json
  </format>
  <buffer tag>
    timekey 300  # 5 minutos
    flush_mode immediate
  </buffer>
</match>

# Guardar todos los otros logs
<match **>
  @type file
  path /shared/logs/consolidated/adn-alert-system
  append true
  <format>
    @type json
  </format>
  <buffer>
    timekey 60
    flush_mode immediate
  </buffer>
</match>
